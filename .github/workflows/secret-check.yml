name: Check required secrets

on:
  workflow_dispatch:

jobs:
  check:
    runs-on: ubuntu-latest
    env:
      SENTRY_DSN: ${{ secrets.SENTRY_DSN }}
      GEMINI_API_KEY: ${{ secrets.GEMINI_API_KEY }}
      TELEMETRY_BACKEND: ${{ secrets.TELEMETRY_BACKEND }}
    steps:
      - name: Check existence of secrets
        run: |
          missing=0
          for s in SENTRY_DSN GEMINI_API_KEY TELEMETRY_BACKEND; do
            if [ -z "${!s}" ]; then
              echo "Missing secret: $s"; missing=1; fi
          done
          if [ "$missing" -eq 1 ]; then
            echo "Missing required secrets"; exit 1;
          fi
